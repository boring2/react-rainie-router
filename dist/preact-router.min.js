!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):t.preactRouter=e(t.React)}(this,function(t){"use strict";function e(t,e){var n=arguments.length<=2||void 0===arguments[2]?m:arguments[2],r=/(?:\?([^#]*))?(#.*)?$/,i=t.match(r),u={},a=void 0;if(i&&i[1])for(var p=i[1].split("&"),c=0;c<p.length;c++){var f=p[c].split("=");u[decodeURIComponent(f[0])]=decodeURIComponent(f.slice(1).join("="))}t=o(t.replace(r,"")),e=o(e||"");for(var l=Math.max(t.length,e.length),s=0;s<l;s++)if(e[s]&&":"===e[s].charAt(0)){var h=e[s].replace(/(^\:|[+*?]+$)/g,""),d=(e[s].match(/[+*?]+$/)||m)[0]||"",v=~d.indexOf("+"),y=~d.indexOf("*"),g=t[s]||"";if(!g&&!y&&(d.indexOf("?")<0||v)){a=!1;break}if(u[h]=decodeURIComponent(g),v||y){u[h]=t.slice(s).map(decodeURIComponent).join("/");break}}else if(e[s]!==t[s]){a=!1;break}return(n.default===!0||a!==!1)&&u}function n(t,e){var n=t.props||m,o=e.props||m;if(n.default)return 1;if(o.default)return-1;var i=r(n.path)-r(o.path);return i||n.path.length-o.path.length}function o(t){return i(t).split("/")}function r(t){return(i(t).match(/\/+/g)||"").length}function i(t){return t.replace(/(^\/+|\/+$)/g,"")}function u(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then}function a(t){var e=arguments.length<=1||void 0===arguments[1]?"push":arguments[1];P&&P[e]?P[e](t):"undefined"!=typeof history&&history[e+"State"]&&history[e+"State"](null,null,t)}function p(){var t=void 0;return t=P&&P.getCurrentLocation?P.getCurrentLocation():"undefined"!=typeof location?location:j,""+(t.pathname||"")+(t.search||"")}function c(t){E.push(t)}function f(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return Promise.all(E.map(function(e){return e(t)})).then(function(){return"string"!=typeof t&&t.url&&(e=t.replace,t=t.url),a(t,e?"replace":"push"),l(t)}).catch(function(t){return console.log(t)})}function l(t){var e=!1;return R.forEach(function(n){n.routeTo(t)===!0&&(e=!0)}),e}function s(t){if(t&&t.getAttribute){var e=t.getAttribute("href"),n=t.getAttribute("target");if(e&&e.match(/^\//g)&&(!n||n.match(/^_?self$/i)))return f(e)}}function h(t){if(0===t.button)return s(t.currentTarget||t.target||this),d(t)}function d(t){return t&&(t.stopImmediatePropagation&&t.stopImmediatePropagation(),t.stopPropagation&&t.stopPropagation(),t.preventDefault()),!1}t="default"in t?t.default:t;var m={},v=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},g=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},b=function(t,e){var n={};for(var o in t)e.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},C=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},O=function(e){function n(){var t,o,r;v(this,n);for(var i=arguments.length,u=Array(i),a=0;a<i;a++)u[a]=arguments[a];return t=o=C(this,e.call.apply(e,[this].concat(u))),o.state={SplitComponent:void 0},r=t,C(o,r)}return g(n,e),n.prototype.componentWillMount=function(){var t=this,e=this.props,n=e.component,o=e.getComponent;if(!n&&o){var r=o();u(r)&&r.then(function(e){t.setState({SplitComponent:e})})}},n.prototype.render=function(){var e=this.props,n=e.component,o=(e.getComponent,b(e,["component","getComponent"])),r=this.state.SplitComponent;return n?t.createElement(n,o):r?t.createElement(r,o):null},n}(t.Component);O.PropTypes={component:t.PropTypes.node,getComponent:t.PropTypes.func};var P=null,R=[],j={},E=[];"function"==typeof addEventListener&&addEventListener("popstate",function(){return l(p())});var w=function(o){function r(t){v(this,r);var e=C(this,o.call(this,t));return t.history&&(P=t.history),e.state={url:e.props.url||p()},e}return g(r,o),r.prototype.shouldComponentUpdate=function(t,e){return t.url!==this.props.url||t.onChange!==this.props.onChange||e.url!==this.state.url},r.prototype.componentWillMount=function(){R.push(this)},r.prototype.componentWillUnmount=function(){R.splice(R.indexOf(this),1)},r.prototype.routeTo=function(t){return this._didRoute=!1,this.setState({url:t}),this._didRoute},r.prototype.render=function(){var o=this.props,r=o.children,i=o.onChange,u=this.state.url,a=null,p=t.Children.toArray(r).sort(n).filter(function(n){var o=n.props,r=o.path,i=e(u,r,o);if(i)return a=t.cloneElement(n,y({},o,{url:u,matches:i})),!0}),c=p[0]||null;this._didRoute=!!c;var f=this.previousUrl;return u!==f&&(this.previousUrl=u,"function"==typeof i&&i({router:this,url:u,previous:f,active:p,current:c})),a},r}(t.Component),x=function(e){var n=e.children,o=b(e,["children"]);return t.createElement("a",y({},o,{onClick:h}),n)};return w.listenBefore=c,w.route=f,w.Router=w,w.Route=O,w.Link=x,w});
//# sourceMappingURL=preact-router.min.js.map